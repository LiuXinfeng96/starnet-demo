/*! 
 Build based on gin-vue-admin 
 Time : 1672224415000 */
import{s as e,_ as l,r as a,g as t,o,c as u,b as s,d as i,w as d,h as r,y as n,G as m,e as p,l as c,i as v}from"./index.32af5906.js";import{a as f}from"./format.fe46b3b1.js";import"./date.23f5a973.js";import"./dictionary.28290efa.js";import"./sysDictionary.b7a85079.js";const b={class:"gva-search-box"},g={class:"gva-table-box"},V={class:"gva-btn-list"},h={key:0},_={class:"gva-pagination"},I={class:"setRuleFormItem"},y={class:"setRuleFormItem"},C={class:"dialog-footer"},w={name:"commandData"},k=l(Object.assign(w,{setup(l){const w=(e,l,a)=>{if(!/^[a-zA-Z0-9._-]{3,30}$/.test(l))return a(new Error("编号须3-30位，由字母、数字以及._-组成"));a()},k=a({instructionId:"",debrisId:"",debrisName:"",satelliteId:"",satelliteName:"",instructionContent:""});a([{value:"1",label:"来源1"},{value:"2",label:"来源2",type:""}]);const N=a(""),z=a({instructionId:[{required:!0,message:"请输入指令编码",trigger:"blur"},{validator:w,trigger:"blur"}],debrisId:[{required:!0,message:"请选择碎片编号",trigger:"blur"},{validator:w,trigger:"blur"}],debrisName:[{required:!0,message:"请输入碎片名称",trigger:"blur"}],satelliteId:[{required:!0,message:"请输入目标卫星编码",trigger:"blur"},{validator:w,trigger:"blur"}],satelliteName:[{required:!0,message:"请输入目标卫星名称",trigger:"blur"}],instructionContent:[{required:!0,message:"请输入指令内容",trigger:"blur"}]}),U=a(1),j=a(0),x=a(10),q=a([]),A=a({}),F=()=>{U.value=1,x.value=10,T()},R=e=>{x.value=e,T()},S=e=>{U.value=e,T()},T=async()=>{let l={page:U.value,pageSize:x.value,...A.value};const a=await(l=>e({url:"/satellitebc/control/getinstructionlist",method:"get",params:l}))(l);200===a.code&&(q.value=a.data,j.value=a.total)};T();const D=a(null),E=a("添加指令数据"),G=a(!1),O=()=>{D.value.resetFields(),k.value={instructionId:"",debrisId:"",debrisName:"",satelliteId:"",satelliteName:"",instructionContent:""},G.value=!1},Z=async()=>{D.value.validate((async l=>{if(l)switch(N.value){case"addApi":0===(await(a=k.value,e({url:"/satellitebc/control/addinstruction",method:"post",data:a}))).code&&v({type:"success",message:"添加成功",showClose:!0}),T(),O();break;case"edit":{const l=await(l=>e({url:"/api/updateApi",method:"post",data:l}))(k.value);0===l.code&&v({type:"success",message:"编辑成功",showClose:!0}),T(),O()}break;default:v({type:"error",message:"未知操作",showClose:!0})}var a}))};return(e,l)=>{const a=t("el-input"),v=t("el-form-item"),w=t("el-button"),T=t("el-form"),$=t("el-table-column"),B=t("el-table"),H=t("el-pagination"),J=t("el-dialog");return o(),u("div",null,[s("div",b,[i(T,{ref:"searchForm",inline:!0,model:A.value},{default:d((()=>[i(v,{label:"指令信息"},{default:d((()=>[i(a,{modelValue:A.value.searchConditions,"onUpdate:modelValue":l[0]||(l[0]=e=>A.value.searchConditions=e),placeholder:"指令信息"},null,8,["modelValue"])])),_:1}),i(v,null,{default:d((()=>[i(w,{size:"small",type:"primary",icon:"search",onClick:F},{default:d((()=>[r("查询")])),_:1})])),_:1})])),_:1},8,["model"])]),s("div",g,[s("div",V,[i(w,{size:"small",type:"primary",icon:"plus",onClick:l[1]||(l[1]=e=>(e=>{switch(e){case"addApi":E.value="添加指令数据";break;case"edit":E.value="修改指令数据";break;case"setRule":E.value="下发规则设置"}N.value=e,G.value=!0})("addApi"))},{default:d((()=>[r("添加")])),_:1})]),i(B,{data:q.value},{default:d((()=>[i($,{align:"left",label:"指令编码",width:"90",prop:"instructionId"}),i($,{align:"left",label:"指令内容",prop:"instructionContent"}),i($,{align:"left",label:"指令生成时间"},{default:d((e=>[r(n(m(f)(e.row.genInstructionTime)),1)])),_:1}),i($,{align:"left",label:"指令来源",prop:"instructionSource"}),i($,{align:"left",label:"碎片编号",prop:"debrisId"}),i($,{align:"left",label:"卫星编码",prop:"satelliteId"}),i($,{align:"left",label:"上链时间",width:"180"},{default:d((e=>[e.row.chainTime?(o(),u("div",h,n(m(f)(e.row.chainTime)),1)):p("",!0)])),_:1})])),_:1},8,["data"]),s("div",_,[i(H,{"current-page":U.value,"page-size":x.value,"page-sizes":[10,30,50,100],total:j.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:S,onSizeChange:R},null,8,["current-page","page-size","total"])])]),i(J,{modelValue:G.value,"onUpdate:modelValue":l[11]||(l[11]=e=>G.value=e),"before-close":O,title:E.value},{footer:d((()=>[s("div",C,[i(w,{size:"small",onClick:O},{default:d((()=>[r("取 消")])),_:1}),i(w,{size:"small",type:"primary",onClick:Z},{default:d((()=>[r("确 定")])),_:1})])])),default:d((()=>["setRule"==N.value?(o(),c(T,{key:0,ref_key:"apiForm",ref:D,model:k.value,rules:z.value},{default:d((()=>[s("div",I,[r(" 指令执行期限前 "),i(v,{prop:"path"},{default:d((()=>[i(a,{modelValue:k.value.path,"onUpdate:modelValue":l[2]||(l[2]=e=>k.value.path=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),r(" s，自动下发指令 ")]),s("div",y,[r(" 在每天 "),i(v,{prop:"path"},{default:d((()=>[i(a,{modelValue:k.value.path,"onUpdate:modelValue":l[3]||(l[3]=e=>k.value.path=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),r(" 至 "),i(v,{prop:"path"},{default:d((()=>[i(a,{modelValue:k.value.path,"onUpdate:modelValue":l[4]||(l[4]=e=>k.value.path=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),r(" 生成的指令自动下发 ")])])),_:1},8,["model","rules"])):p("",!0),"addApi"==N.value||"edit"==N.value?(o(),c(T,{key:1,ref_key:"apiForm",ref:D,model:k.value,rules:z.value,"label-width":"120px"},{default:d((()=>[i(v,{label:"指令编码",prop:"instructionId"},{default:d((()=>[i(a,{modelValue:k.value.instructionId,"onUpdate:modelValue":l[5]||(l[5]=e=>k.value.instructionId=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),i(v,{label:"碎片编号",prop:"debrisId"},{default:d((()=>[i(a,{modelValue:k.value.debrisId,"onUpdate:modelValue":l[6]||(l[6]=e=>k.value.debrisId=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),i(v,{label:"碎片名称",prop:"debrisName"},{default:d((()=>[i(a,{modelValue:k.value.debrisName,"onUpdate:modelValue":l[7]||(l[7]=e=>k.value.debrisName=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),i(v,{label:"目标卫星编码",prop:"satelliteId"},{default:d((()=>[i(a,{modelValue:k.value.satelliteId,"onUpdate:modelValue":l[8]||(l[8]=e=>k.value.satelliteId=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),i(v,{label:"目标卫星名称",prop:"satelliteName"},{default:d((()=>[i(a,{modelValue:k.value.satelliteName,"onUpdate:modelValue":l[9]||(l[9]=e=>k.value.satelliteName=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),i(v,{label:"指令内容",prop:"instructionContent"},{default:d((()=>[i(a,{type:"textarea",modelValue:k.value.instructionContent,"onUpdate:modelValue":l[10]||(l[10]=e=>k.value.instructionContent=e),autocomplete:"off"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])):p("",!0)])),_:1},8,["modelValue","title"])])}}}),[["__scopeId","data-v-20871f61"]]);export{k as default};
